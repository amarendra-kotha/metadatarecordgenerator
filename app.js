!function(e){function s(s){for(var a,o,r=s[0],n=s[1],d=s[2],c=0,h=[];c<r.length;c++)o=r[c],Object.prototype.hasOwnProperty.call(l,o)&&l[o]&&h.push(l[o][0]),l[o]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);for(p&&p(s);h.length;)h.shift()();return i.push.apply(i,d||[]),t()}function t(){for(var e,s=0;s<i.length;s++){for(var t=i[s],a=!0,r=1;r<t.length;r++){var n=t[r];0!==l[n]&&(a=!1)}a&&(i.splice(s--,1),e=o(o.s=t[0]))}return e}var a={},l={1:0},i=[];function o(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=a,o.d=function(e,s,t){o.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,s){if(1&s&&(e=o(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)o.d(t,a,function(s){return e[s]}.bind(null,a));return t},o.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(s,"a",s),s},o.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},o.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],n=r.push.bind(r);r.push=s,r=r.slice();for(var d=0;d<r.length;d++)s(r[d]);var p=n;i.push([1,0]),t()}([,function(e,s,t){e.exports=t(3)},function(e,s){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,s,t){"use strict";t.r(s);var a=t(0);var l=[function(e,s,t){return"td"+s+",th"+s+"{padding:.36rem .5rem!important}.hcolor"+s+"{fill:pink;stroke-width:2px;vertical-align:middle}.slds-button_brand"+s+"{background-color:#fb610e!important;border-color:#fb610e!important}.slds-scope"+s+" .slds-button--brand:disabled"+s+",.slds-scope"+s+" .slds-button--brand[disabled]"+s+",.slds-scope"+s+" .slds-button_brand:disabled"+s+",.slds-scope"+s+" .slds-button_brand[disabled]"+s+"{background:#c9c7c5!important;border-color:#c9c7c5!important;color:#fff}"}];function i(e,s,t,l){const{t:i,h:o,fid:r,gid:n,b:d,d:p,k:c,i:h}=e,{_m0:u,_m1:m,_m2:f}=l;return[o("div",{classMap:{"slds-scope":!0},key:76},[s.showSpinner?o("div",{classMap:{spinner:!0,"slds-spinner_container":!0},key:4},[o("div",{classMap:{"slds-spinner":!0,"slds-spinner_medium":!0,"slds-spinner_brand":!0},attrs:{role:"status"},key:3},[o("span",{classMap:{"slds-assistive-text":!0},key:0},[i("Loading..")]),o("div",{classMap:{"slds-spinner__dot-a":!0},key:1},[]),o("div",{classMap:{"slds-spinner__dot-b":!0},key:2},[])])]):null,o("div",{styleMap:{height:"100vh","/*paddingTop":"4rem",paddingBottom:"4rem"},key:75},[o("div",{styleMap:{maxWidth:"55rem",marginLeft:"auto",marginRight:"auto"},key:67},[o("div",{classMap:{"slds-align_absolute-center":!0,"slds-p-top_x-large":!0,"slds-p-bottom_large":!0},key:12},[o("span",{classMap:{"slds-icon_container":!0,null:!0,"slds-icon__svg--default":!0},key:7},[o("svg",{classMap:{"slds-icon":!0,"slds-icon--large":!0},attrs:{"aria-hidden":"true"},key:6},[o("use",{attrs:{"xlink:href":Object(a.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href",r(s.csviconurl))},key:5},[])])]),o("span",{classMap:{"slds-p-left_x-small":!0,"slds-p-right_x-small":!0},styleMap:{color:"#ffffff",fontSize:"1.5rem"},key:8},[i("➔")]),o("span",{classMap:{"slds-icon_container":!0,null:!0,"slds-icon__svg--default":!0},key:11},[o("svg",{classMap:{"slds-icon":!0,"slds-icon--large":!0},attrs:{"aria-hidden":"true"},key:10},[o("use",{attrs:{"xlink:href":Object(a.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href",r(s.zipiconurl))},key:9},[])])])]),o("div",{classMap:{"slds-align_absolute-center":!0,"slds-p-bottom_small":!0},key:14},[o("p",{classMap:{"slds-text-align_center":!0,"slds-text-heading_medium":!0},styleMap:{width:"60%",color:"#ffffff",fontSize:"1.25rem"},key:13},[i("Convert CSV file to a deployable 'Custom Metadata' records")])]),o("div",{classMap:{"slds-container_center":!0,"slds-p-around_x-large":!0,"slds-m-around_small":!0},styleMap:{borderRadius:"25px",background:"#fff",marginRight:"1.5rem",marginLeft:"1.5rem",boxShadow:"rgba(0, 0, 0, 0.2) 0px 4px 18px"},key:66},[o("div",{classMap:{"slds-text-heading_small":!0,"slds-m-bottom_small":!0},styleMap:{fontWeight:"600"},key:15},[i("1. Add your CSV File")]),o("div",{classMap:{"slds-form-element":!0},key:24},[o("div",{classMap:{"slds-form-element__control":!0},key:23},[o("div",{classMap:{"slds-file-selector":!0,"slds-file-selector_files":!0},key:22},[o("div",{classMap:{"slds-file-selector__dropzone":!0},key:21},[o("input",{classMap:{"slds-file-selector__input":!0,"slds-assistive-text":!0},attrs:{type:"file",accept:".csv",id:n("file-upload-input-01"),"aria-labelledby":`${n("file-selector-primary-label")} ${n("file-selector-secondary-label")}`},key:16,on:{change:u||(l._m0=d(s.handleFileChange))}},[]),o("label",{classMap:{"slds-file-selector__body":!0},attrs:{for:`${n("file-upload-input-01")}`,id:n("file-selector-secondary-label")},key:20},[o("span",{classMap:{"slds-file-selector__button":!0,"slds-button":!0,"slds-button_neutral":!0},key:19},[o("svg",{classMap:{"slds-button__icon":!0,"slds-button__icon_left":!0},attrs:{"aria-hidden":"true"},key:18},[o("use",{attrs:{"xlink:href":Object(a.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href",r(s.uploadiconurl))},key:17},[])]),i("Upload CSV")])])])])])]),o("div",{classMap:{"slds-text-heading_small":!0,"slds-m-bottom_small":!0,"slds-m-top_small":!0},styleMap:{fontWeight:"600"},key:25},[i("2. Choose datatype for columns in CSV file")]),s.csvheaders?o("div",{key:46},h(s.csvheaders,(function(e){return o("div",{classMap:{"slds-p-around_xx-small":!0},styleMap:{width:"80%"},key:c(45,e)},[o("div",{classMap:{"slds-form-element":!0},key:44},[o("label",{classMap:{"slds-form-element__label":!0},attrs:{for:`${n("select-01")}`},key:26},[p(e)]),o("div",{classMap:{"slds-form-element__control":!0},key:43},[o("div",{classMap:{"slds-select_container":!0},key:42},[o("select",{classMap:{"slds-select":!0},attrs:{"data-col":e,"data-text":e},key:41,on:{change:m||(l._m1=d(s.handleMapping))}},[o("option",{attrs:{value:""},key:27},[i("Please select type")]),o("option",{attrs:{value:"xsd:string"},key:28},[i("Metadata Relationship")]),o("option",{attrs:{value:"xsd:boolean"},key:29},[i("Checkbox")]),o("option",{attrs:{value:"xsd:date"},key:30},[i("Date")]),o("option",{attrs:{value:"xsd:dateTime"},key:31},[i("Date/Time")]),o("option",{attrs:{value:"xsd:string"},key:32},[i("Email")]),o("option",{attrs:{value:"xsd:double"},key:33},[i("Number")]),o("option",{attrs:{value:"xsd:double"},key:34},[i("Percent")]),o("option",{attrs:{value:"xsd:string"},key:35},[i("Phone")]),o("option",{attrs:{value:"xsd:string"},key:36},[i("Picklist")]),o("option",{attrs:{value:"xsd:string"},key:37},[i("Text")]),o("option",{attrs:{value:"xsd:string"},key:38},[i("Text Area")]),o("option",{attrs:{value:"xsd:string"},key:39},[i("Text Area (Long)")]),o("option",{attrs:{value:"xsd:string"},key:40},[i("URL")])])])])])])}))):null,s.hasCsvHeaders?null:o("div",{classMap:{"slds-align_absolute-center":!0},key:55},[o("div",{classMap:{"slds-scoped-notification":!0,"slds-media":!0,"slds-media_center":!0},attrs:{role:"status"},key:54},[o("div",{classMap:{"slds-media__figure":!0},key:51},[o("span",{classMap:{"slds-icon_container":!0,"slds-icon-utility-info":!0},attrs:{title:"information"},key:50},[o("svg",{classMap:{"slds-icon":!0,"slds-icon_small":!0,"slds-icon-text-default":!0},attrs:{"aria-hidden":"true"},key:48},[o("use",{attrs:{"xlink:href":Object(a.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href",r(s.infoiconurl))},key:47},[])]),o("span",{classMap:{"slds-assistive-text":!0},key:49},[i("information")])])]),o("div",{classMap:{"slds-media__body":!0},key:53},[o("p",{key:52},[i("Upload CSV File to see Datatype mapping.")])])])]),o("div",{classMap:{"slds-text-heading_small":!0,"slds-m-bottom_small":!0,"slds-m-top_small":!0},styleMap:{fontWeight:"600"},key:56},[i("3. Download")]),o("button",{classMap:{"slds-button":!0,"slds-button_brand":!0,downloadBtn:!0},props:{disabled:"disabled"},key:57,on:{click:f||(l._m2=d(s.downloadNow))}},[i("Download")]),o("ul",{classMap:{"slds-p-top_large":!0},key:65},[o("li",{key:58},[i("Notes:")]),o("li",{key:64},[o("ul",{classMap:{"slds-is-nested":!0,"slds-list_dotted":!0},key:63},[o("li",{key:59},[i("Mandatory Columns in CSV File: DeveloperName and Label")]),o("li",{key:61},[i("Use ANT Migration Tool or "),o("a",{attrs:{href:"https://workbench.developerforce.com/metadataDeploy.php",target:"_blank"},key:60},[i("Workbench")]),i(" to deploy the zip file.")]),o("li",{key:62},[i("Tested in latest versions of Google Chrome and Firefox.")])])])])])]),o("div",{classMap:{"slds-align_absolute-center":!0,"slds-p-top_small":!0},styleMap:{color:"#FFFFFF"},key:74},[o("div",{classMap:{"slds-text-body_regular":!0},key:73},[i("Built with "),o("a",{styleMap:{color:"#FFFFFF"},attrs:{href:"https://lwc.dev/"},key:68},[i("LWC Opensource")]),i(" by "),o("a",{styleMap:{color:"#FFFFFF"},attrs:{href:"https://twitter.com/Amarendra_Kotha"},key:69},[i("@Amarendra_Kotha")]),i("  -  "),o("svg",{classMap:{hcolor:!0},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"rgb(57, 63, 73)","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},key:71},[o("path",{attrs:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},key:70},[])]),i(" "),o("a",{styleMap:{color:"#FFFFFF"},attrs:{href:"https://salesforce.com"},key:72},[i("Salesforce")])])])])])]}var o=Object(a.registerTemplate)(i);i.stylesheets=[],l&&i.stylesheets.push.apply(i.stylesheets,l),i.stylesheetTokens={hostAttribute:"my-metadataRecordGenerator-_metadataRecordGenerator-host",shadowAttribute:"my-metadataRecordGenerator-_metadataRecordGenerator"};class r extends a.LightningElement{constructor(){super(),this.showSpinner=!0,this.hasCsvHeaders=!1,this.csvheaders=void 0,this.csviconurl=void 0,this.zipiconurl=void 0,this.uploadiconurl=void 0,this.infoiconurl=void 0,this.reader=void 0,this.tempcsvheader=void 0,this.csvcontent=void 0,this.fileName=void 0,this.zip=void 0,this.mapping=new Map,this.headerMapping=void 0,this.packageFile='<?xml version="1.0" encoding="UTF-8"?><Package xmlns="http://soap.sforce.com/2006/04/metadata"><types><members>*</members><name>CustomMetadata</name></types><version>47.0</version></Package>',this.csviconurl=document.location+"/resources/slds/assets/icons/doctype-sprite/svg/symbols.svg#csv",this.zipiconurl=document.location+"/resources/slds/assets/icons/doctype-sprite/svg/symbols.svg#zip",this.uploadiconurl=document.location+"/resources/slds/assets/icons/utility-sprite/svg/symbols.svg#upload",this.infoiconurl=document.location+"/resources/slds/assets/icons/utility-sprite/svg/symbols.svg#info";const e=document.createElement("link");e.href=document.location+"resources/slds/assets/styles/salesforce-lightning-design-system-vf.min.css",e.rel="stylesheet",this.template.appendChild(e);const s=document.createElement("script");s.src=document.location+"resources/scripts/jszip.min.js",this.template.appendChild(s)}connectedCallback(){this.showSpinner=!1,this.csvheaders=[],this.csvcontent=[],this.headerMapping=new Map}handleFileChange(e){const s=e.target.files[0];s?(this.showSpinner=!0,this.mapping=new Map,this.mapping.DeveloperName="xsd:string",this.mapping.Label="xsd:string",this.fileName=s.name.replace(".csv",""),this.reader=new FileReader,this.reader.onloadend=e=>{let s=e.target.result.split("\r\n"),t=s[0].split(",");t.forEach(e=>{this.headerMapping[e]=t.indexOf(e)}),this.tempcsvheader=t.toString().split(","),t.includes("DeveloperName")&&t.splice(t.indexOf("DeveloperName"),1),t.includes("Label")&&t.splice(t.indexOf("Label"),1),this.csvheaders=t,s.splice(0,1),this.csvcontent=s,this.value="",this.showSpinner=!1,this.hasCsvHeaders=!0},this.reader.readAsBinaryString(s)):(this.mapping=new Map,this.headerMapping=new Map,this.csvheaders=[],this.csvcontent=[],this.hasCsvHeaders=!1)}handleMapping(e){let s=e.target;this.showSpinner=!0,s.value&&""!==s.value?this.mapping[s.dataset.text]=s.value:delete this.mapping[s.dataset.text];let t=this.template.querySelector(".downloadBtn");Object.keys(this.mapping).length===this.tempcsvheader.length?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled"),this.showSpinner=!1}downloadNow(){this.zip=new JSZip,this.zip.folder("src"),this.zip.folder("src").file("package.xml",this.prettifyXml(this.packageFile)),this.zip.folder("src").folder("customMetadata"),this.generateMetadataXML(this.csvcontent,this.downloadNowHelper)}generateMetadataXML(e,s){return e.forEach(e=>{let s,t,a=e.split(","),l='<?xml version="1.0" encoding="UTF-8"?><CustomMetadata xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><label></label><protected>false</protected>';Object.keys(this.mapping).forEach(e=>{"DeveloperName"===e?s=a[this.headerMapping[e]]:"Label"===e?t=a[this.headerMapping[e]]:l=l+"<values><field>"+e+'</field><value xsi:type="'+this.mapping[e]+'">'+a[this.headerMapping[e]]+"</value></values>"}),s&&t&&(l=(l+="</CustomMetadata>").replace("<label></label>","<label>"+t+"</label>"),this.zip.folder("src").file("package.xml",this.prettifyXml(this.packageFile)),this.zip.folder("src").folder("customMetadata").file(this.fileName+"."+s+".md",l))}),this.zip.generateAsync({type:"blob"}).then((function(e){let s=document.createElement("a"),t=URL.createObjectURL(e);s.href=t,s.download="src",s.click()})),s}prettifyXml(e){var s=(new DOMParser).parseFromString(e,"application/xml"),t=(new DOMParser).parseFromString(['<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">','   <xsl:strip-space elements="*"/>','   <xsl:template match="para[content-style][not(text())]">','       <xsl:value-of select="normalize-space(.)"/>',"   </xsl:template>",'   <xsl:template match="node()|@*">','       <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>',"   </xsl:template>",'   <xsl:output indent="yes"/>',"</xsl:stylesheet>"].join("\n"),"application/xml"),a=new XSLTProcessor;a.importStylesheet(t);let l=a.transformToDocument(s);return(new XMLSerializer).serializeToString(l)}}Object(a.registerDecorators)(r,{track:{showSpinner:1,hasCsvHeaders:1,csvheaders:1,csviconurl:1,zipiconurl:1,uploadiconurl:1,infoiconurl:1},fields:["reader","tempcsvheader","csvcontent","fileName","zip","mapping","headerMapping","packageFile"]});var n=Object(a.registerComponent)(r,{tmpl:o});customElements.define("my-app",Object(a.buildCustomElementConstructor)(n))}]);
